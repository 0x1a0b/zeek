# @TEST-EXEC: bro -b %INPUT > output
# @TEST-EXEC: btest-diff output

# This is loaded by default
@load base/utils/queue

event bro_init()
	{
	local q = Queue::init([$max_len=2]);
	Queue::push(q, 1);
	Queue::push(q, 2);
	Queue::push(q, 3);
	Queue::push(q, 4);
	local test1 =  Queue::get_cnt_vector(q);
	for ( i in test1 )
		print fmt("This is a get_cnt_vector test: %d", test1[i]);

	local test2 =  Queue::get_str_vector(q);
	for ( i in test2 )
		print fmt("This is a get_str_vector test: %s", test2[i]);

	local test_val = Queue::pop(q);
	print fmt("Testing pop: %s", test_val);
	print fmt("Length after pop: %d", Queue::len(q));

	local q2 = Queue::init([]);
	Queue::push(q2, "test 1");
	Queue::push(q2, "test 2");
	Queue::push(q2, "test 2");
	Queue::push(q2, "test 1");
	print fmt("Size of q2: %d", Queue::len(q2));
	local test3: vector of string = Queue::get_str_vector(q2);
	for ( i in test3 )
		print fmt("String queue value: %s", test3[i]);
	}